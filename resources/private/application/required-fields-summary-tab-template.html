<script class="ko-template" type="text/x-jquery-tmpl" id="required-fields-summary-tab-template">
  <div id="application-requiredFieldSummary-tab" data-bind="with: $root.application" class="tab-content">
      <div>
          <h1 data-bind="ltext: 'application.tabRequiredFieldSummary'"></h1>

          <div class="clear spacerM"></div>
          <!-- ko if: municipalityHearsNeighborsVisible -->
          <div class="form-grid form-grid--no-border">
            <div class="row">
              <div data-bind="component: {name: 'checkbox-field', params: {value: optionMunicipalityHearsNeighbors, id: 'optionMunicipalityHearsNeighbors', lLabel: 'application.municipality-hears-neighbors', disable: optionMunicipalityHearsNeighborsDisabled}}" ></div>
            </div>
          </div>
          <!-- /ko -->

          <div data-bind="visible: submitErrors().length > 0 && $root.authorization.ok('submit-application')" data-test-id="submit-errors-container">
            <h2 data-bind="ltext: 'application.not-submittable'"></h2>
            <div data-bind="foreach: submitErrors">
              <div class="info-line like-btn">
                  <i class="lupicon-circle-attention"></i>
                  <span data-bind="ltext: $data, attr: {'data-test-id': 'submit-error-' + $index(), 'data-submit-error': $data}"></span>
              </div>
            </div>
          </div>

          <!-- ko ifnot: missingSomeInfo -->
          <h2 data-bind="ltext: 'application.allRequiredDataFilled'" class="missing-info-title"></h2>
          <!-- /ko -->
          
          <button class="positive top-marginM"
                  data-test-id="application-submit-btn"
                  data-bind="click: submitApplication,
                             visible: $root.authorization.ok( 'submit-application' ),
                             enable: submitButtonEnabled">
              <i class="lupicon-download"></i>
              <span data-bind="ltext: 'application.submitApplication'"></span>
          </button>

          <div class="auth-actions stacked inner-margins">
              <button data-bind="click: approveApplication,
                                 visible: $root.authorization.ok('approve-application'),
                                 enable: !processing() && $root.authorization.ok('approve-application'), attr: {'title': loc('tooltip.approveApplication')}"
                      data-test-id="approve-application-summaryTab"
                      class="positive">
                  <i class="lupicon-circle-arrow-right"></i>
                  <span data-bind="ltext: 'application.approveApplication'"></span>
              </button>

              <button data-bind="click: toAsianhallinta,
                                 visible: $root.authorization.ok('application-to-asianhallinta') && asianhallintaEnabled,
                                 enable: !processing() && $root.authorization.ok('application-to-asianhallinta') && asianhallintaEnabled,
                                 attr: {'title': loc('tooltip.toAsianhallinta')}"
                      data-test-id="to-asianhallinta-summaryTab"
                      class="positive">
                  <i class="lupicon-circle-arrow-right"></i>
                  <span data-bind="ltext: 'application.toAsianhallinta'"></span>
              </button>
          </div>

          <!-- missing information -->

          <!-- ko if: hasFieldWarnings -->
          <div id="applicationWarnings" data-test-id="test-application-warnings">
            <h2 data-bind="ltext: 'application.warningsInDocument'" class="missing-info-title"></h2>
            <!-- ko foreach: fieldWarnings -->
              <div data-bind="with: $data[0]">
                 <h3 class="required-field-error-doc" data-bind="ltext: document.name + '._group_label'"></h3>
              </div>
              <!-- ko foreach: $data -->
                <div class="info-line warning">
                    <div class="like-btn">
                        <i class="lupicon-circle-attention"></i>
                        <span class="required-field-error-element-name" data-bind="ltext: element.locKey"></span>
                    </div>
                    <a data-bind="click: $root.application.moveToIncorrectlyFilledRequiredField, ltext: 'view'" href="#"></a>
                </div>
              <!-- /ko -->
            <!-- /ko -->
          </div>
          <!-- /ko -->

          <!-- ko if: hasIncorrectlyFilledRequiredFields -->
          <div id="applicationRequiredFields" data-test-id="test-application-required-fields">
            <h2 data-bind="ltext: 'application.requiredDataMissing'" class="missing-info-title"></h2>
            <!-- ko foreach: incorrectlyFilledRequiredFields -->
              <div data-bind="with: $data[0]">
                  <h3 class="required-field-error-doc" data-bind="ltext: document.name + '._group_label'"></h3>
              </div>
              <!-- ko foreach: $data -->
              <div class="info-line">
                  <div class="like-btn">
                      <i class="lupicon-circle-attention"></i>
                      <span class="required-field-error-element-name" data-bind="ltext: element.locKey"></span>
                  </div>
                  <a data-bind="click: $root.application.moveToIncorrectlyFilledRequiredField, ltext: 'view'" href="#"></a>
              </div>
              <!-- /ko -->
            <!-- /ko -->
          </div>
          <!-- /ko -->

          <!-- ko if: hasMissingRequiredAttachments -->
          <div id="applicationRequiredAttachments" data-test-id="test-application-required-attachments">
            <h2 data-bind="ltext: 'application.missingRequiredAttachments'" class="missing-info-title"></h2>
            <!-- ko foreach: missingRequiredAttachments -->
              <h3 class="required-field-error-doc"
                  data-bind="text: loc(['attachmentType', $data[0], '_group_label'])"></h3>
              <!-- ko foreach: $data[1] -->
                <div class="info-line">
                    <div class="like-btn">
                        <i class="lupicon-circle-attention"></i>
                        <span class="required-field-error-element-name"
                              data-bind="text: loc(['attachmentType', type['type-group'](), type['type-id']()])"></span>
                    </div>
                    <a data-bind="click: $root.application.moveToMissingRequiredAttachment, ltext: 'view'" href="#"></a>
                </div>
              <!-- /ko -->
            <!-- /ko -->
          </div>
          <!-- /ko -->

      </div>

      <!-- /missing information -->

      <div class="process-nav">
          <a class="btn secondary process-previous" data-bind="click: $root.application.nextTab" href="#" data-target="attachments">
              <i class="lupicon-chevron-left"></i>
              <span data-bind="ltext: 'application.previous-tab'"></span>
          </a>
      </div>
  </div>
</script>

