<script type="text/x-jquery-tmpl" class="ko-template"
        id="attachments-table-template">
  <div class="attachments-table-container">
    <table class="attachments-table">
      <thead>
        <tr>
          <th data-bind="ltext:'application.attachmentState'"></th>
          <th data-bind="ltext: 'attachment.th-type'"
              class="attachments-table--widest"></th>
          <th data-bind="ltext: 'application.attachmentFile'"></th>
          <th data-bind="ltext: 'attachment.th-not-needed'"></th>
          <th data-bind="ltext: 'ok'"></th>
          <th data-bind="ltext: 'attachment.th-not-ok'"></th>
          <th data-bind="ltext: 'remove'"></th>
        </tr>
      </thead>
      <tbody data-bind="foreach: attachments">
        <tr data-bind="attr: {'data-test-type': $data.type()['type-group'] + '.' + $data.type()['type-id'],
                              'data-test-state': $data.state}">
          <td data-bind="foreach: $parent.stateIcons( $data )"
              class="attachments-table__state-icons">
            <i data-bind="attr: {'class': $data.css,
                                 'data-test-icon':  $data.icon + '-icon'}"></i>
          </td>
          <!-- ko if: $parent.hasFile( $data ) -->
          <td>
            <a data-bind="click: $parent.openAttachment"
               data-test-id="open-attachment">
              <span data-bind="text: loc(['attachmentType', type()['type-group'], type()['type-id']])"></span>
              <span data-bind="visible: $data.ramLink, ltext: 'ram.postfix'" data-test-id="ram-indicator"></span>
            </a>
            <br>
            <span data-bind="text: $data.contents() || ''"
                  data-test-id="attachment-contents"></span>
          </td>
          <td data-bind="attachmentVersion: latestVersion"
              data-test-id="file-info"></td>
          <td>
            <span data-bind="dateString: latestVersion.created"></span><br>
            <span data-bind="firstLastName: latestVersion.user"></span>
          </td>
          <!-- /ko -->
          <!-- ko ifnot: $parent.hasFile( $data ) -->
          <td>
            <span data-bind="text: loc(['attachmentType', type()['type-group'], type()['type-id']])"></span>
            <span data-bind="visible: $data.ramLink, ltext: 'ram.postfix'" data-test-id="ram-indicator"></span>
            <br>
            <span data-bind="html: loc(['attachmentType', type['type-group'], type['type-id'], 'info'])"></span>
          </td>
          <td data-bind="if: !$parent.isNotNeeded( $data )">
            <a class="link-btn link-btn--link"
               data-bind="click: $parent.openAttachment"
               data-test-id="open-attachment">
              <i class="lupicon-circle-plus"></i>
              <span data-bind="ltext: 'attachment.addFile'"
                    data-test-id="add-file-link"></span>
            </a>
          </td>
          <td data-bind="if: $data.authModel.ok('set-attachment-not-needed')">
            <div class="checkbox-wrapper">
              <input type="checkbox"
                     data-bind="attr: {'id': $parent.inputId( $index() ),
                                       'data-test-id': 'not-needed-checkbox' },
                                checked: $data.notNeeded">
              <label class="checkbox-label"
                     data-bind="attr: {'for': $parent.inputId( $index()),
                                       'data-test-id': 'not-needed-label'},
                                ltext: 'application.attachmentNotNeeded'"></label>
            </div>
          </td>
          <!-- /ko -->
          <td>
            <button class="btn-icon-only"
                    data-bind="enable: $data.authModel.ok('approve-attachment'),
                               css: { positive: $parent.isApproved( $data ),
                                      'no-events': $parent.isApproved( $data ),
                                      approve: !$parent.isApproved( $data ) },
                               click: $parent.approve,
                               clickBubble: false">
              <i class="lupicon-check"></i>
            </button>
          </td>
          <td>
            <button class="btn-icon-only"
                    data-bind="enable: $data.authModel.ok('reject-attachment'),
                               css: { negative: $parent.isRejected( $data ),
                                      'no-events': $parent.isRejected( $data ),
                                      reject: !$parent.isRejected( $data ) },
                               click: $parent.reject,
                               clickBubble: false">
              <i class="lupicon-circle-attention"></i>
            </button>
          </td>
          <td>
            <button class="secondary btn-icon-only"
                    data-bind="click: $parent.remove,
                               clickBubble: false,
                               enable: $data.authModel.ok('delete-attachment')"
                    data-test-icon="delete-button">
              <i class="lupicon-remove"></i>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</script>
